%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%% App. X: Cylinder Functions  %%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% -------------------------------------
% labels: \label{[type]:cylinder:[name]}
% -------------------------------------

% ¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
% LOCAL MACROS:
\newcommand{\myemph}{\textbf}
\newcommandx\Zv[1][1=\nu]{\Cylindrical[#1][Z]}
\newcommandx\zn[1][1=n]{\Cylindrical[#1][z]}
\newcommandx\Rzn[1][1=n]{\Cylindrical[#1][R]}
% ¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨




We will in the following define the first and second kinds of the (regular) Bessel functions, spherical Bessel functions and Riccati--Bessel functions, collectively denoted $\Zv[]$, $\zn[]$ and $\Rzn[]$, respectively. The second kinds are also called the Neumann, spherical Neumann and Riccati--Neumann functions. Conventions are shown in~\cref{tab:cylinder:Bessel_functions}, and we use $\nu\in\Complex$ and $n\in\Integer$ to denote the order.


\begin{table}[h]
    \import{tables/Appendices/}{Bessel_functions.tex}
    \caption{Types of Bessel functions and conventions. Here, $\nu\in\Complex$ and $n\in \Integer$ are constants, and $x\in \Complex$ is a variable. Linear combinations of the first and second kinds are denoted in the second column. Subscripts mean order, and parenthesised superscripts refer to kind.}
    \label{tab:cylinder:Bessel_functions}
\end{table}

% \paragraph{Bessel functions.} %
The general solution to Bessel's differential equation ($'\equiv \dv*{}{x}$)
\begin{equation}\label{eq:cylinder:Bessels_eq}
    x^2 y'' + x y' + (x^2 -\nu^2 )y = 0
\end{equation}
is $y(x) = \Zv(x)$; a linear combination of the (regular) $\nu$th-order \newconcept{Bessel} (first kind, $\Bessel$) and \newconcept{Neumann} (second kind, $\Neumann$) \newconcept{functions}.



% \section{Variations of Bessel's equation}



% Bessel's differential equation



% \speak{Rewrite this to simpler version!} 

% % Cylinder functions, also generally known as \newconcept{Bessel functions}, are 
% Consider the ODE
% \begin{equation}
%     x^2 y'' + x y' + (x^2 -\nu^2 )y = 0
% \end{equation}
% % where $'\equiv \dv*{}{x}$ and $x\in \Complex$. Solutions to this equation, $y(x)=\Zv(x)$, are {cylinder functions}, also generally known as {Bessel functions}. % where $\Zv[] =  \sum_{i=1,2} c_i \Zv[]^{(i)} =c_1 \Bessel[] + c_2 \Neumann[]$ and %
% % $\nu\in\Complex$ is then the order of the Bessel functions, and 
% $\Zv[]$ represents a linear combination of the regular Bessel functions of the first and second kind, $\Zv[] =  \sum_{i=1,2} c_i \Zv[]^{(i)}$, known as the \myemph{Bessel} and \myemph{Neumann functions} $\Bessel[]$ and $\Neumann[]$, respectively.



% In the following, we will define and \blahblah 
% \begin{itemize}
%     \item $\Zv[]$ rep
%     \item $\zn[]$
%     \item $\Rzn[]$ 
% \end{itemize}

% \section{IDK}


The solution to a similar equation% Bessel's equation
\begin{equation}
    x^2y'' + x{(1-2a)}y'+ \bclosed{ {(bcx^{c})}^2 + {(a^2-\nu^2 c^2)} }y = 0
\end{equation}
is $y(x) = x^a \Cylindrical[\nu](bx^c)$. %
% \begin{equation}
%     y(x) = x^a \Cylindrical[\nu](bx^c).
% \end{equation}
% where $\Cylindrical[\nu]$ is a linear combination of the Bessel functions of the first and second kind, $\Bessel$ and $\Neumann$.
A variation of this is the spherical Bessel's equation
\begin{equation}
    x^2 y'' + 2x y' + \pclosed{ x^2 - n(n+1) }y = 0
\end{equation}
has the general solution $y(x)=\zn[n](x)$; a linear combination of the $n$th-order \newconcept{spherical Bessel} (first kind, $\sphBessel$) and \newconcept{Neumann} (second kind, $\sphNeumann$) \newconcept{functions}.
Another useful class of solutions is the general solution to
\begin{equation}
    x^2 y'' + \pclosed{ x^2 - n(n+1) }y = 0,
\end{equation}
which is $y(x)= \Rzn(x)$; a linear combination of the $\nu$th-order \newconcept{Riccati--Bessel} (first kind, $\RiccatiBessel$) and \newconcept{Riccati--Neumann} (second kind, $\RiccatiNeumann$) \newconcept{functions}.




% \begin{equation}
% %     \zn[n]^{(i)} = \sqrt{\frac{\ppi}{2x}} \Zv[n+1/2]^{(i)}(x),
% % \end{equation}
% represent the \myemph{spherical Bessel} (first kind) and \myemph{Neumann} (second kind) functions, given by
%     % For $\nu=n+1/2$ we can express the functions in terms of \myemph{spherical Bessel} (first kind) and \myemph{Neumann} (second kind) functions
%     \begin{subequations}\label{eq:cylinder:spherical_Bessel}
%         % \begin{align}
%         %     \sphBessel[n](x) &= \sqrt{\frac{\ppi}{2x}} \Bessel[n+1/2](x)= +x^n \pclosed{-\frac{1}{x} \dv{}{x}}^n \pclosed{ \frac{\sin{x}}{x}}  ,\\
%         %     \sphNeumann[n](x) &= \sqrt{\frac{\ppi}{2x}} \Neumann[n+1/2](x)=- x^n \pclosed{-\frac{1}{x} \dv{}{x}}^n \pclosed{ \frac{\cos{x}}{x}}.
%         % \end{align}
%         \begin{align}
%             \sphBessel[n](x) &= +x^n \pclosed{-\frac{1}{x} \dv{}{x}}^n \pclosed{ \frac{\sin{x}}{x}}  ,\\
%             \sphNeumann[n](x) &= - x^n \pclosed{-\frac{1}{x} \dv{}{x}}^n \pclosed{ \frac{\cos{x}}{x}}.
%         \end{align}
%         % These are linearly independent solutions to 
%         % \begin{equation}
%         %     x^2 y'' + 2x y' + \pclosed{ x^2 - n(n+1) }y = 0.
%         % \end{equation}
%     \end{subequations}
%     % As a collective term, we use $\Cylindrical[n][z]$ for the spherical Bessel functions of first and second kind. 
%     These are related to the \myemph{Riccati--Bessel} (first kind) and \myemph{--Neumann functions} (second kind) by
%     \begin{subequations}\label{eq:cylinder:Riccati_Bessel}
%         \begin{align}
%             \RiccatiBessel[n](x) &= +x\sphBessel[n](x),\\
%             \RiccatiNeumann[n](x) &= -x\sphNeumann[n](x),
%         \end{align}
%         that satisfy
%         \begin{equation}
%             x^2 y'' + \pclosed{ x^2 - n(n+1) }y = 0.
%         \end{equation}
%     \end{subequations}
%     We will use $\Cylindrical[n][R]$ as a reference to either of these special functions. 
%     Note that $\RiccatiBessel[0](x)=\sin{x}$ and $\RiccatiNeumann[0](x)=\cos{x}$. 

%     \begin{align}
%         \zn^{(i)}(x) &= \sqrt{\frac{\ppi}{2x}} \Zv[n+1/2]^{(i)}(x) \\
%         \Rzn^{(i)}(x) &= (-1)^{i-1} x\zn^{(i)}(x)
%     \end{align}

\section{Explicit formulas} 
    \subsection{Integer order}
        Bessel functions of integer order, the $\Zv[n]$'s are given by
        \begin{subequations}
            \begin{equation}
                \Bessel[n](x) = \frac{1}{\ppi} \integ{y}[0][\ppi] \cos{(ny-x \sin{y})}
            \end{equation}
            and
            \begin{equation}
                \Neumann[n](x) = \lim_{\nu\to n} \Neumann(x),
            \end{equation}
            where
            \begin{equation}
                \Neumann(x) = \frac{\Bessel(x)\cos{\ppi \nu} - \Bessel[-\nu](x)}{\sin{\ppi\nu}}; \quad \nu\not\in \Integer.
            \end{equation}
        \end{subequations}
        Furthermore,
        \begin{equation}
            \Zv[-n](x) = (-1)^n \Zv[n](x).
        \end{equation}
    
    \subsection{Half-integer order}
        If $\nu=n+\frac{1}{2}$, we have $\Zv[n+1/2](x) = \sqrt{2x/\ppi}\, \zn(x)$ where
        \begin{subequations}
            \begin{align}
                \sphBessel[n](x) &= +x^n \pclosed{-\frac{1}{x} \dv{}{x}}^n \pclosed{ \frac{\sin{x}}{x}}  ,\\
                \sphNeumann[n](x) &= - x^n \pclosed{-\frac{1}{x} \dv{}{x}}^n \pclosed{ \frac{\cos{x}}{x}},
            \end{align}
        \end{subequations}
        are the spherical Bessel functions. %
        Observe that 
        \begin{subequations}
            \begin{align}
                \sphBessel(x) &= (-1)^n \sphNeumann[-(n+1)](x), \\
                \sphNeumann(x) &= (-1)^{n+1} \sphBessel[-(n+1)](x). \\
            \end{align}
        \end{subequations}
        We also have the Riccati--Bessel functions
        \begin{subequations}\label{eq:cylinder:Riccati_Bessel}
            \begin{align}
                \RiccatiBessel[n](x) &= +x\sphBessel[n](x) = +\sqrt{\frac{\ppi x}{2}} \Bessel[n+1/2](x),\\
                \RiccatiNeumann[n](x) &= -x\sphNeumann[n](x)  = -\sqrt{\frac{\ppi x}{2}} \Neumann[n+1/2](x).
            \end{align}
        \end{subequations}

        





% \section{Useful identities}


\section{Properties}

\subsection{Some notable identities}
    We list some notable recurrence relations:
    \begin{subequations}
        \begin{align}
           \frac{2\nu}{x}\Zv(x) &= \Zv[\nu-1](x) + \Zv[\nu+1](x), \label{eq:derivations:cylinder:recurr_Z_plus}\\
            2\Zv'(x) &= \Zv[\nu-1](x) - \Zv[\nu+1](x),\label{eq:derivations:cylinder:recurr_Z_minus} \\
            \Zv[\nu]'(x) &= \Zv[\nu-1](x) - \frac{\nu}{x}\Zv[\nu](x),\label{eq:derivations:cylinder:recurr_Z_minus_vol2} \\
            % \Zv[\nu]' &= \Zv[\nu-1]' - \frac{\nu}{x}\Zv[\nu] \\
            \pclosed{x^\nu \Zv[\nu](x)}' &= x^\nu \Zv[\nu-1] (x),\label{eq:derivations:cylinder:der_idk_Z_123} \\
            \zn'(x) &= \frac{n}{x}\zn(x) -\zn[n+1](x).
        \end{align}
    \end{subequations}


    The \newconcept{Jacobi--Anger expansion} reads
    \begin{subequations}\label{eq:cylinder:Jacobi_Anger}
        \begin{align}
            \eu[\im a \sin{bx}]  &= \sum_{n=-\infty}^{\infty} \Bessel[n](a) \eu[\im n bx],\label{eq:cylinder:Jacobi_Anger_sin} \\
            \eu[\im a \cos{bx}]  &= \sum_{n=-\infty}^{\infty} \im^{n}\Bessel[n](a) \eu[\im n bx] \label{eq:cylinder:Jacobi_Anger_cos}.
        \end{align}
    \end{subequations}
    


\subsection{Asymptotic behaviour}
    \iftime{Write something}

    \begin{subequations}\label{eq:cylinder:prop:JacobiAnger}
        \begin{align}
            % \Bessel(x) &\stackrel{x \to \infty}{\simeq}  
            \lim_{x\to \infty} \Bessel(x) &=
            \sqrt{\frac{2}{\ppi x}} \cos{(x - \nu \ppi/2 - \ppi/4)}, \label{eq:cylinder:prop:JacobiAnger_sin}  \\
            % \Neumann(x) &\stackrel{x \to \infty}{\simeq} 
            \lim_{x\to \infty} \Neumann(x) &=
            \sqrt{\frac{2}{\ppi x}} \sin{(x - \nu \ppi/2 - \ppi/4)},\label{eq:cylinder:prop:JacobiAnger_cos} 
        \end{align}
    \end{subequations}


